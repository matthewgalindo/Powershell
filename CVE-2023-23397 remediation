Function Test-RegistryValue {
    param(
        [Alias("PSPath")]
        [Parameter(Position = 0, Mandatory = $true, ValueFromPipeline = $true, ValueFromPipelineByPropertyName = $true)]
        [String]$Path
        ,
        [Parameter(Position = 1, Mandatory = $true)]
        [String]$Name
        ,
        [Switch]$PassThru
    ) 
    process {
        if (Test-Path $Path) {
            $Key = Get-Item -LiteralPath $Path
            if ($Key.GetValue($Name, $null) -ne $null) {
                if ($PassThru) {
                    Get-ItemProperty $Path $Name
                } else {
                    $true
                }
            } else {
                $false
            }
        } else {
            $false
        }
    }
}
$RegExists = Test-RegistryValue -Path HKLM:\SYSTEM\CurrentControlSet\Control\Lsa -Name NoLMHash
If ($RegExists -eq "True") {
 $RegValue =  (Get-ItemProperty -Path HKLM:\SYSTEM\CurrentControlSet\Control\Lsa -Name NoLMHash).NoLMHash
  if ($RegValue -eq "1") {
 Write-Host "1"
 }
 Elseif ($RegValue -eq "0") {
 Write-host "0"
 }
 Else {
 Write-host "0"
 }
 }
 Else {
 Write-host "0"
 }
